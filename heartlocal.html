<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

        <title>Babylon.js sample code</title>

        <!-- Babylon.js -->
        <script src="https://code.jquery.com/pep/0.4.2/pep.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.6.2/dat.gui.min.js"></script>
        <script src="babylondist/cannon.js"></script>
        <script src="babylondist/Oimo.js"></script>
        <script src="babylondist/earcut.min.js"></script>
        <script src="babylondist/babylon.js"></script>
        <script src="babylondist/inspector/babylon.inspector.bundle.js"></script>
        <script src="babylondist/materialsLibrary/babylonjs.materials.min.js"></script>
        <script src="babylondist/proceduralTexturesLibrary/babylonjs.proceduralTextures.min.js"></script>
        <script src="babylondist/postProcessesLibrary/babylonjs.postProcess.min.js"></script>
        <script src="babylondist/loaders/babylonjs.loaders.js"></script>
        <script src="babylondist/serializers/babylonjs.serializers.min.js"></script>
        <script src="babylondist/gui/babylon.gui.min.js"></script>
    	<script src="babylondist/loaders/babylon.stlFileLoader.js"></script>
    	<script src="babylondist/loaders/babylon.glTFFileLoader.js"></script>
    	<script src="babylondist/loaders/babylon.objFileLoader.js"></script>
    	
    	
        <style>
            html, body {
                overflow: hidden;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }

            #renderCanvas {
                width: 100%;
                height: 100%;
                touch-action: none;
            }
        </style>
    </head>
<body>
    <canvas id="renderCanvas"></canvas>
    <script>
        var canvas = document.getElementById("renderCanvas");
        var engine = new BABYLON.Engine(canvas, true);
        
        var createScene = function () {
            var scene = new BABYLON.Scene(engine);
            scene.ambientColor = new BABYLON.Color3(1, 1, 1);
            
                    
            var light = new BABYLON.PointLight("Omni", new BABYLON.Vector3(0, 100, 100), scene);
            var light2 = new BABYLON.PointLight("Omni", new BABYLON.Vector3(0, -100, -100), scene);
            var camera = new BABYLON.ArcRotateCamera("Camera", 0, 0.8, 100, BABYLON.Vector3.Zero(), scene);
            camera.attachControl(canvas, true);
        
            // material
            var mat = new BABYLON.StandardMaterial("mat1", scene);
            mat.alpha = 1.0;
            mat.diffuseColor = new BABYLON.Color3(0.5, 0.5, 1.0);
            mat.backFaceCulling = false;
        
            /************Start Pilot*********************************/
            var body = BABYLON.MeshBuilder.CreateCylinder("body", { height: 0.75, diameterTop: 0.2, diameterBottom: 0.5, tessellation: 6, subdivisions: 1 }, scene);
            var arm = BABYLON.MeshBuilder.CreateBox("arm", { height: 0.75, width: 0.3, depth: 0.1875 }, scene);
            arm.position.x = 0.125;
            var pilot = BABYLON.Mesh.MergeMeshes([body, arm], true);
            /*************End Pilot****************************************/
        
            /************Set Center of Rotation (CoR) Position, Axis and Pilot Start Position********/
            var CoR_At = new BABYLON.Vector3(0.5, 1.5, 1);
            var axis = new BABYLON.Vector3(2, 6, 4);
            var pilotStart = new BABYLON.Vector3(2, 4, 4);
            /****************************************************************/
        
            /****************Draw Axis and Sphere to show Pivot Position*****************/
            var axisLine = BABYLON.MeshBuilder.CreateLines("axisLine", { points: [CoR_At.add(axis.scale(-50)), CoR_At.add(axis.scale(50))] }, scene);
        
            var sphere = BABYLON.MeshBuilder.CreateSphere("sphere", { diameter: 0.25 }, scene);
            /****************************************************************/
        
            /**********Pilot Pivot*********/
            var pivot = new BABYLON.TransformNode("root");
            pivot.position = CoR_At; 
            pilot.parent = pivot;
            pilot.position = pilotStart;
            /***************************************************************/
        
            /**********Sphere at pivot position for viewing*********/
            sphere.parent = pivot;
            sphere.position = pivot.position;
            /***************************************************************/
        
        
            /**************Animation of Rotation**********/
        
            /*-------------------Animation--------------------*/
        	var a = 0; // for oscillation
            var angle=0.025; 
            var axisNormal = axis.normalize();
            var direction = new BABYLON.Vector3(2, 1, 3).normalize();   
            scene.registerAfterRender(function() {
                a +=0.005;
                var sign = Math.cos(a)/Math.abs(Math.cos(a));
                pivot.rotate(axis, angle, BABYLON.Space.LOCAL);  
                pivot.position = pivot.position.add(direction.scale(0.01 * sign));
                axisLine.position = axisLine.position.add(direction.scale(0.01 * sign)); 
        	}); 
            /***************************************************************/
        
        
        
        
        ////////////////////////////////////////////////////////////////////
        // Torus
            var torus = BABYLON.Mesh.CreateTorus("torus", 8, 2, 32, scene, false);
            torus.position.x = 25;
            torus.position.z = 30;
        
            var materialBox = new BABYLON.StandardMaterial("texture1", scene);
            materialBox.diffuseColor = new BABYLON.Color3(0, 1, 0);//Green
                
                var myMaterial = new BABYLON.StandardMaterial("myMaterial", scene);

                myMaterial.diffuseColor = new BABYLON.Color3(1, 0, 1);
                //myMaterial.specularColor = new BABYLON.Color3(0.5, 0.6, 0.87);
                myMaterial.emissiveColor = new BABYLON.Color3(0.1, 0.2, 1);
                myMaterial.ambientColor = new BABYLON.Color3(0.23, 0.98, 0.53);

                myMaterial.alpha = 0.7;
                //myMaterial.wireframe = true;
                
           // var myMaterial2 = new BABYLON.StandardMaterial("myMaterial2", scene);

            //myMaterial2.diffuseTexture = new BABYLON.Texture("3dfiles/Human_heart_Aorta_DIFFUSE.jpg", scene);
            //myMaterial2.diffuseTexture = new BABYLON.Texture("3dfiles/Human_heart_Arteritas_DIFFUSE.jpg", scene);
            //myMaterial2.diffuseTexture = new BABYLON.Texture("3dfiles/Human_heart_Auricula_der_DIFFUSE.jpg", scene);
            //myMaterial2.diffuseTexture = new BABYLON.Texture("3dfiles/Human_heart_Auricula_izq_DIFFUSE.jpg", scene);
            //myMaterial2.diffuseTexture = new BABYLON.Texture("3dfiles/Human_heart_Venitas_DIFFUSE.jpg", scene);
            //myMaterial2.diffuseTexture = new BABYLON.Texture("3dfiles/Human_heart_Ventriculos_DIFFUSE.jpg", scene);


            //myMaterial2.specularTexture = new BABYLON.Texture("PATH TO IMAGE", scene);
            //myMaterial2.emissiveTexture = new BABYLON.Texture("PATH TO IMAGE", scene);
            //myMaterial2.ambientTexture = new BABYLON.Texture("PATH TO IMAGE", scene);

            //mesh.material = myMaterial;    
            //myMaterial2.alpha = 0.5;
                
            //var myMaterial3 = new BABYLON.StandardMaterial("myMaterial3", scene);

            //myMaterial3.diffuseTexture = new BABYLON.Texture("3dfiles/Human_heart.mtl", scene);   
                
            // -----------------------------------------
            // Creation of an easing animation within predefined easing functions
            // ------------------------------------------
                    // 3 parameters to create an event:
            // - The frame at which the event will be triggered
            // - The action to execute
            // - A boolean if the event should execute only once (false by default)
            var event1 = new BABYLON.AnimationEvent(50, function() { console.log("Yeah!"); }, true);
            // Attach your event to your animation
            //animation.addEvent(event1);
            
            //start of above comment
            //Create a Vector3 animation at 30 FPS
            var animationTorus = new BABYLON.Animation("torusEasingAnimation", "position", 30, BABYLON.Animation.ANIMATIONTYPE_VECTOR3, BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE);
        
            // the torus destination position
            var nextPos = torus.position.add(new BABYLON.Vector3(-80, 0, 0));
            

            
            // Animation keys
            var keysTorus = [];
            keysTorus.push({ frame: 0, value: torus.position });
            keysTorus.push({ frame: 120, value: nextPos });
            keysTorus.push({ frame: 240, value: torus.position });
            
            animationTorus.setKeys(keysTorus);
        
            // Adding an easing function
            // You can use :
            //1.	CircleEase()
            //2.	BackEase(amplitude)
            //3.	BounceEase(bounces, bounciness)
            //4.	CubicEase()
            //5.	ElasticEase(oscillations, springiness)
            //6.	ExponentialEase(exponent)
            //7.	PowerEase(power)
            //8.	QuadraticEase()
            //9.	QuarticEase()
            //10.	QuinticEase()
            //11.	SineEase()
            // And if you want a total control, you can use a Bezier Curve animation
            //12.   BezierCurveEase(x1, y1, x2, y2)
            var easingFunction = new BABYLON.SineEase();
        
            // For each easing function, you can choose beetween EASEIN (default), EASEOUT, EASEINOUT
            easingFunction.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEINOUT);
        
            // Adding easing function to my animation
            animationTorus.setEasingFunction(easingFunction);
        
            // Adding animation to my torus animations collection
            torus.animations.push(animationTorus);
        
            //Finally, launch animations on torus, from key 0 to key 120 with loop activated
            scene.beginAnimation(torus, 0, 240, true);
        
            // ------------------------------------------
            // Using Bezier curve to create a custom easing function
            // See here to see some samples and values : http://cubic-bezier.com/
            // -----------------------------------------
        
            // Torus
            var bezierTorus = BABYLON.Mesh.CreateTorus("torus", 8, 2, 32, scene, false);
            bezierTorus.position.x = 25;
            bezierTorus.position.z = 0;
            
            //
            // materials added to heart
            //

                
                
            //  **************HEART********************
            //var newMeshes = [];
            // The first parameter can be used to specify which mesh to import. Here we import all meshes

          
                      // The first parameter can be used to specify which mesh to import. Here we import all meshes
            BABYLON.SceneLoader.ImportMesh("", "3dfiles/", "skull.babylon", scene, function (newMeshes) {
                // Set the target of the camera to the first imported mesh
                newMeshes[0].position =  new BABYLON.Vector3(0,20,0);
                newMeshes[0].scaling = new BABYLON.Vector3(0.2, 0.2, 0.2);
                newMeshes[0].rotation = new BABYLON.Vector3(0, 90, 0);

            });

                                  // The first parameter can be used to specify which mesh to import. Here we import all meshes
           BABYLON.SceneLoader.ImportMesh("", "3dfiles/", "Human_heart.babylon", scene, function (someMeshes) {
                // Set the target of the camera to the first imported mesh
//            myMaterial2.diffuseTexture = new BABYLON.Texture("3dfiles/Human_heart_Aorta_DIFFUSE.jpg", scene);
//            myMaterial2.diffuseTexture = new BABYLON.Texture("3dfiles/Human_heart_Arteritas_DIFFUSE.jpg", scene);
//            myMaterial2.diffuseTexture = new BABYLON.Texture("3dfiles/Human_heart_Auricula_der_DIFFUSE.jpg", scene);
//            myMaterial2.diffuseTexture = new BABYLON.Texture("3dfiles/Human_heart_Auricula_izq_DIFFUSE.jpg", scene);
//            myMaterial2.diffuseTexture = new BABYLON.Texture("3dfiles/Human_heart_Venitas_DIFFUSE.jpg", scene);
//            myMaterial2.diffuseTexture = new BABYLON.Texture("3dfiles/Human_heart_Ventriculos_DIFFUSE.jpg", scene);
                //someMeshes[0].material = myMaterial;
                
                        console.log(someMeshes.length);
        console.log(someMeshes[0]);
        console.log(someMeshes[1]);
        console.log(someMeshes[2]);
        console.log(someMeshes[3]);
        console.log(someMeshes[4]);
        console.log(someMeshes[5]);
        
         //someMeshes[0].showBoundingBox = true;
         //someMeshes[1].showBoundingBox = true;
         //someMeshes[2].showBoundingBox = true;
         //someMeshes[3].showBoundingBox = true;
         //someMeshes[4].showBoundingBox = true;
         //someMeshes[5].showBoundingBox = true;
        
        
        
                                //someMeshes[0].position =  new BABYLON.Vector3(0, 0,0);
                                //someMeshes[1].position =  new BABYLON.Vector3(0, 0,0);
                                //someMeshes[2].position =  new BABYLON.Vector3(0, 0,0);
                                //someMeshes[3].position =  new BABYLON.Vector3(0, 0,0);
                                //someMeshes[4].position =  new BABYLON.Vector3(0, 0,0);
                                //someMeshes[5].position =  new BABYLON.Vector3(0, 0,0);
                                //someMeshes[6].position =  new BABYLON.Vector3(0,0,0);
                                //someMeshes[0].rotation =  new BABYLON.Vector3(0, Math.PI/2,0);
                                //someMeshes[1].rotation =  new BABYLON.Vector3(0, Math.PI/2,0);
                                //someMeshes[2].rotation =  new BABYLON.Vector3(0, Math.PI/2,0);
                                //someMeshes[3].rotation =  new BABYLON.Vector3(0, Math.PI/2,0);
                                //someMeshes[4].rotation =  new BABYLON.Vector3(0, Math.PI/2,0);
                                //someMeshes[5].rotation =  new BABYLON.Vector3(0, Math.PI/2,0);
                                
                                //scene.beforeRender = function() {
                                // someMeshes[0].rotation.y += .01;
                                // someMeshes[1].rotation.y += .01;
                                // someMeshes[2].rotation.y += .01;
                                // someMeshes[3].rotation.y += .01;
                                // someMeshes[4].rotation.y += .01;
                                // someMeshes[5].rotation.y += .01;
                                //}
                                
                                var master = BABYLON.Mesh.CreateBox("master", 2, scene);
                                someMeshes[0].parent = master;
                                someMeshes[1].parent = master;
                                someMeshes[2].parent = master;
                                someMeshes[3].parent = master;
                                someMeshes[4].parent = master;
                                someMeshes[5].parent = master;
                                master.position =  new BABYLON.Vector3(0, 0,0);
        var beta = Math.PI;

        scene.beforeRender = function() {
            master.rotation.y += .01;
            master.scaling = new BABYLON.Vector3(Math.cos(beta)+1.2, Math.cos(beta)+1.2, Math.cos(beta)+1.2);
            master.position.y = Math.cos(beta)*4;
            beta += .01;
        }
                                
 //               newMeshes[0].scaling = new BABYLON.Vector3(0.2, 0.2, 0.2);
//                newMeshes[0].rotation = new BABYLON.Vector3(0, 180, 0);
//pilot.rotation.x  =  alpha; //rotation around x axis
               // var beta = (Math.PI/2);
                //setup3(newMeshes[0]);
                //newMeshes[0].rotation.y  =  beta; //rotation around y axis
//pilot.rotation.z  =  gamma; //rotation around z axis
        //var url4 = "https://cdn.rawgit.com/bluemage/babylon-personal/master/Human_heart_Arteritas_DIFFUSE.jpg";

        //someMeshes[4].material.diffuseTexture = new BABYLON.Texture(url4, scene);

        //var url5 = "https://upload.wikimedia.org/wikipedia/commons/thumb/3/34/Tiled_brick_pattern.jpg/480px-Tiled_brick_pattern.jpg";

       // someMeshes[5].material.diffuseTexture = new BABYLON.Texture(url5, scene);
            });

           //function setup3(mesh){
           //mesh.rotation = new BABYLON.Vector3(0, Math.PI/3, 0);
           //};
           
           
           
           
///////////////////////////////Dead code/////////////////////////
     //       BABYLON.SceneLoader.ImportMesh("", "3dfiles/", "Human_heart.gltf", scene, function (newMeshes) {
                // Set the target of the camera to the first imported mesh

                //camera.target = newMeshes[0];
       //         newMeshes[0].material = myMaterial;
         //       newMeshes[0].position = new BABYLON.Vector3(0, 0, -40);
              //  newMeshes[0].addRotation(Math.PI/2, 0, 0);
              // the torus destination position
           //   setup2(newMeshes[0]);
  //});
  
              //////////////////////second setup function for gltf file
    /*        function setup2(mesh){
                        var nextPos22 = mesh.position.add(new BABYLON.Vector3( 0, 0, 80));
            // Animation keys
            var keysHeart2 = [];
            keysHeart2.push({ frame: 0, value: mesh.position });
            keysHeart2.push({ frame: 120, value: nextPos2 });
            keysHeart2.push({ frame: 240, value: mesh.position });
                        //Create a Vector3 animation at 30 FPS
            var animationHeart2 = new BABYLON.Animation("heartEasingAnimation", "position", 30, BABYLON.Animation.ANIMATIONTYPE_VECTOR3, BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE);
        
            //add animation keys to animation
            animationHeart2.setKeys(keysHeart);
                        
                         // Adding easing function to my animation
            animationHeart2.setEasingFunction(easingFunction);
        
            // Adding animation to my torus animations collection
            mesh.animations.push(animationHeart2);

            //Finally, launch animations on torus, from key 0 to key 120 with loop activated
            scene.beginAnimation(mesh, 0, 240, true);

            }
        
      */  
      /////////////////////END DEAD CODE//////////////////////
            
            
            // The first parameter can be used to specify which mesh to import. Here we import all meshes
            //obj try
            /*BABYLON.SceneLoader.ImportMesh("", "3dfiles/", "Human_heart.obj", scene, function (newMeshes) {
                // Set the target of the camera to the first imported mesh
                newMeshes[0].position =  new BABYLON.Vector3(0,0,0);
                //newMeshes[0].scaling = new BABYLON.Vector3(0.2, 0.2, 0.2);
                //newMeshes[0].rotation = new BABYLON.Vector3(0, 90, 0);
                newMeshes[0].material = myMaterial;
            });
            
            */
        
            BABYLON.SceneLoader.ImportMesh("", "3dfiles/", "Human_heart.stl", scene, function (newMeshes) {
                // Set the target of the camera to the first imported mesh

                //camera.target = newMeshes[0];
                newMeshes[0].material = myMaterial;
                newMeshes[0].position = new BABYLON.Vector3(0, 0, -40);
                //newMeshes[0].rotation = new BABYLON.Vector3(0, Math.PI/2, 0);
              //  newMeshes[0].addRotation(Math.PI/2, 0, 0);
              // the torus destination position
              setup(newMeshes[0]);
  });
            function setup(mesh){
                        var nextPos2 = mesh.position.add(new BABYLON.Vector3( 0, 0, 80));
            // Animation keys
            var keysHeart = [];
            keysHeart.push({ frame: 0, value: mesh.position });
            keysHeart.push({ frame: 120, value: nextPos2 });
            keysHeart.push({ frame: 240, value: mesh.position });
                        //Create a Vector3 animation at 30 FPS
            var animationHeart = new BABYLON.Animation("heartEasingAnimation", "position", 30, BABYLON.Animation.ANIMATIONTYPE_VECTOR3, BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE);
        
            //add animation keys to animation
            animationHeart.setKeys(keysHeart);
                        
                         // Adding easing function to my animation
            animationHeart.setEasingFunction(easingFunction);
        
            // Adding animation to my torus animations collection
            mesh.animations.push(animationHeart);

            //Finally, launch animations on torus, from key 0 to key 120 with loop activated
            scene.beginAnimation(mesh, 0, 240, true);

            }
//BABYLON.SceneLoader.ImportMesh("Suzanne", "asset/", "head1.babylon", scene, function (newMeshes, particleSystems) {    setup(newMeshes[0]);});

//where the setup(mesh) function would be all actions related to your imported model, for example : 

//function setup(mesh) {    mesh.position.x = 3    //...}


          
            
            
            //////////////////////////////////////////return to program
            // Create the animation
            var animationBezierTorus = new BABYLON.Animation("animationBezierTorus", "position", 30, BABYLON.Animation.ANIMATIONTYPE_VECTOR3, BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE);
            var keysBezierTorus = [];
            keysBezierTorus.push({ frame: 0, value: bezierTorus.position });
            keysBezierTorus.push({ frame: 120, value: bezierTorus.position.add(new BABYLON.Vector3(-80, 0, 0)) });
            keysBezierTorus.push({ frame: 240, value: bezierTorus.position });
            animationBezierTorus.setKeys(keysBezierTorus);
            var bezierEase = new BABYLON.BezierCurveEase(0.32, -0.73, 0.69, 1.59);
            animationBezierTorus.setEasingFunction(bezierEase);
            bezierTorus.animations.push(animationBezierTorus);
            scene.beginAnimation(bezierTorus, 0, 240, true);
        
            // ------------------------------------------
            // Create a simple animation without easing functions
            // ------------------------------------------
        
            var torus0 = BABYLON.Mesh.CreateTorus("torus", 8, 2, 32, scene, false);
            torus0.position.x = 25;
            torus0.position.z = -30;
            torus0.material = materialBox;
        
            BABYLON.Animation.CreateAndStartAnimation("anim", torus0, "position", 30, 240,
                     torus0.position, torus0.position.add(new BABYLON.Vector3(-80, 0, 0)));
        

                 /*********************************Start World Axes********************/
    var showAxis = function (size) {
        var makeTextPlane = function (text, color, size) {
            var dynamicTexture = new BABYLON.DynamicTexture("DynamicTexture", 50, scene, true);
            dynamicTexture.hasAlpha = true;
            dynamicTexture.drawText(text, 5, 40, "bold 36px Arial", color, "transparent", true);
            var plane = new BABYLON.Mesh.CreatePlane("TextPlane", size, scene, true);
            plane.material = new BABYLON.StandardMaterial("TextPlaneMaterial", scene);
            plane.material.backFaceCulling = false;
            plane.material.specularColor = new BABYLON.Color3(0, 0, 0);
            plane.material.diffuseTexture = dynamicTexture;
            return plane;
        };

        var axisX = BABYLON.Mesh.CreateLines("axisX", [
            new BABYLON.Vector3.Zero(), new BABYLON.Vector3(size, 0, 0), new BABYLON.Vector3(size * 0.95, 0.05 * size, 0),
            new BABYLON.Vector3(size, 0, 0), new BABYLON.Vector3(size * 0.95, -0.05 * size, 0)
        ], scene);
        axisX.color = new BABYLON.Color3(1, 0, 0);
        var xChar = makeTextPlane("X", "red", size / 10);
        xChar.position = new BABYLON.Vector3(0.9 * size, -0.05 * size, 0);
        var axisY = BABYLON.Mesh.CreateLines("axisY", [
            new BABYLON.Vector3.Zero(), new BABYLON.Vector3(0, size, 0), new BABYLON.Vector3(-0.05 * size, size * 0.95, 0),
            new BABYLON.Vector3(0, size, 0), new BABYLON.Vector3(0.05 * size, size * 0.95, 0)
        ], scene);
        axisY.color = new BABYLON.Color3(0, 1, 0);
        var yChar = makeTextPlane("Y", "green", size / 10);
        yChar.position = new BABYLON.Vector3(0, 0.9 * size, -0.05 * size);
        var axisZ = BABYLON.Mesh.CreateLines("axisZ", [
            new BABYLON.Vector3.Zero(), new BABYLON.Vector3(0, 0, size), new BABYLON.Vector3(0, -0.05 * size, size * 0.95),
            new BABYLON.Vector3(0, 0, size), new BABYLON.Vector3(0, 0.05 * size, size * 0.95)
        ], scene);
        axisZ.color = new BABYLON.Color3(0, 0, 1);
        var zChar = makeTextPlane("Z", "blue", size / 10);
        zChar.position = new BABYLON.Vector3(0, 0.05 * size, 0.9 * size);
    };
    /***************************End World Axes***************************/
        showAxis(8);
        
            return scene;
        }
        
        var scene = createScene()

        engine.runRenderLoop(function () {
            if (scene) {
                scene.render();
            }
        });

        // Resize
        window.addEventListener("resize", function () {
            engine.resize();
        });
    </script>
</body>
</html>

//https://cdn.rawgit.com/bluemage/blob/master/
//https://cdn.rawgit.com/bluemage/babylon-personal/master/Human_heart.babylon
